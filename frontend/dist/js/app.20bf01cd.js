(function(e){function t(t){for(var r,o,i=t[0],c=t[1],l=t[2],d=0,h=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(h.length)h.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],r=!0,i=1;i<s.length;i++){var c=s[i];0!==a[c]&&(r=!1)}r&&(n.splice(t--,1),e=o(o.s=s[0]))}return e}var r={},a={app:0},n=[];function o(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=r,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(s,r,function(t){return e[t]}.bind(null,r));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/webapp/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"031e":function(e,t,s){"use strict";var r=s("0ab9"),a=s.n(r);a.a},"0553":function(e,t,s){"use strict";var r=s("8947"),a=s.n(r);a.a},"08d0":function(e,t,s){},"0ab9":function(e,t,s){},1082:function(e,t,s){"use strict";var r=s("3b8a"),a=s.n(r);a.a},"128d":function(e,t,s){"use strict";var r=s("1d86"),a=s.n(r);a.a},"1d86":function(e,t,s){},"29b2":function(e,t,s){"use strict";var r=s("3380"),a=s.n(r);a.a},3380:function(e,t,s){},"3b8a":function(e,t,s){},"4a77":function(e,t,s){},"4b5a":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("d3b7"),s("e260"),s("e6cf"),s("cca6"),s("a79d"),s("691b");var r=s("2b0e"),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",[s("the-header"),s("the-nav-bar"),s("main",[s("section",{staticClass:"content"},[s("alert"),s("router-view")],1),"development"===e.vueCliMode?s("v-checkbox",{attrs:{label:"Keycloak Dev Tools"},model:{value:e.showKeycloakTools,callback:function(t){e.showKeycloakTools=t},expression:"showKeycloakTools"}}):e._e(),e.showKeycloakTools?s("KeycloakDevTools"):e._e()],1),s("the-footer")],1)},n=[],o=(s("4160"),s("caad"),s("a15b"),s("2532"),s("159b"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",[s("div",{attrs:{id:"header"}},[s("section",{staticClass:"container"},[e._m(0),s("section",{staticClass:"options user-select-off"},[s("a",{staticClass:"sign-out",attrs:{id:"logoutLink"},on:{click:e.logout}},[e._v("Sign Out")])])])])])}),i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"identity"},[r("img",{staticClass:"logo",attrs:{src:s("9d64"),width:"154",alt:"BC Government Logo"}}),r("div",{staticClass:"sitename"},[e._v("MoH User Management")])])}],c={name:"TheHeader",methods:{logout:function(){this.$keycloak.logout({redirectUri:this.$config.siteminder_logout})}}},l=c,u=(s("0553"),s("2877")),d=Object(u["a"])(l,o,i,!1,null,"a4942ed6",null),h=d.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("nav",{attrs:{role:"navigation"}},[s("div",{staticClass:"container"},[s("ul",[s("li",{class:"UserSearch"==e.$route.name||"UserUpdate"==e.$route.name||"UserCreate"==e.$route.name?"active":"inactive",attrs:{id:"users-link"}},[s("router-link",{attrs:{to:{name:"UserSearch"}},nativeOn:{click:function(t){return e.resetAlert(t)}}},[e._v("Users")])],1),s("li",{class:"AdminEventLog"==e.$route.name?"active":"inactive",attrs:{id:"admin-event-log-link"}},[s("router-link",{attrs:{to:{name:"AdminEventLog"}},nativeOn:{click:function(t){return e.resetAlert(t)}}},[e._v("User History")])],1),s("li",{class:"EventLog"==e.$route.name?"active":"inactive",attrs:{id:"event-log-link"}},[s("router-link",{attrs:{to:{name:"EventLog"}},nativeOn:{click:function(t){return e.resetAlert(t)}}},[e._v("Login Events")])],1)])])])},m=[],p={name:"TheNavBar",methods:{resetAlert:function(){this.$store.commit("alert/dismissAlert")}}},v=p,g=(s("29b2"),Object(u["a"])(v,f,m,!1,null,"35caf06c",null)),b=g.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("footer",{staticClass:"primary"},[s("div",{staticClass:"container"},[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"col-3"},[s("ul",[s("li",[s("a",{attrs:{href:"https://www2.gov.bc.ca/gov/content/home/get-help-with-government-services",target:"_blank"}},[e._v("Contact Us")])])])]),s("v-col",{staticClass:"col-3"},[s("ul",[s("li",[s("a",{attrs:{href:"http://www2.gov.bc.ca/gov/content/home/disclaimer",target:"_blank"}},[e._v("Disclaimer")])]),s("li",[s("a",{attrs:{href:"http://www2.gov.bc.ca/gov/content/home/privacy",target:"_blank"}},[e._v("Privacy")])]),s("li",[s("a",{attrs:{href:"http://www2.gov.bc.ca/gov/content/home/accessibility",target:"_blank"}},[e._v("Accessibility")])]),s("li",[s("a",{attrs:{href:"http://www2.gov.bc.ca/gov/content/home/copyright",target:"_blank"}},[e._v("Copyright")])])])])],1)],1)])},y=[],_={name:"TheFooter"},x=_,U=(s("bee3"),s("6544")),w=s.n(U),E=s("62ad"),C=s("0fd9"),I=Object(u["a"])(x,k,y,!1,null,"0b7e6b32",null),R=I.exports;w()(I,{VCol:E["a"],VRow:C["a"]});var T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-alert",{attrs:{id:"primary-alert",type:e.type,dismissible:""},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[e._v(e._s(e.message))])],1)},S=[],A=s("5530"),$=s("2f62"),D={computed:Object(A["a"])({},Object($["b"])("alert",{message:function(e){return e.message},type:function(e){return e.type}}),{active:{get:function(){return this.$store.state.alert.active},set:function(){this.$store.commit("alert/dismissAlert")}}})},O=D,N=s("0798"),V=Object(u["a"])(O,T,S,!1,null,null,null),j=V.exports;w()(V,{VAlert:N["a"]});var P=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"col1"},[s("h2",[e._v("User Account")]),s("v-btn",{attrs:{small:""},on:{click:e.loadProfile}},[e._v("Get Profile")]),s("v-btn",{attrs:{small:""},on:{click:e.updateProfile}},[e._v("Update profile")])],1),s("div",{staticClass:"col1"},[s("h2",[e._v("Token Information")]),s("v-btn",{attrs:{small:""},on:{click:e.loadUserInfo}},[e._v("Get User Info")]),s("v-btn",{attrs:{small:""},on:{click:e.showToken}},[e._v("Show Token")]),s("v-btn",{attrs:{small:""},on:{click:e.showRefreshToken}},[e._v("Show Refresh Token")]),s("v-btn",{attrs:{small:""},on:{click:e.showIdToken}},[e._v("Show ID Token")]),s("v-btn",{attrs:{small:""},on:{click:e.showExpires}},[e._v("Show Expires")]),s("v-btn",{attrs:{small:""},on:{click:e.showDetails}},[e._v("Show Details")])],1),s("div",{staticClass:"col4"},[s("label",{staticStyle:{"font-weight":"600"}},[e._v("Result")]),s("pre",{staticStyle:{"background-color":"#ddd",border:"1px solid #ccc",padding:"10px","word-wrap":"break-word","white-space":"pre-wrap","margin-bottom":"20px"},attrs:{id:"output"}},[e._v(e._s(e.result))])])])},L=[],G=(s("ac1f"),s("1276"),{name:"KeycloakDevTools",data:function(){return{result:""}},methods:{loadUserInfo:function(){var e=this;this.$keycloak.loadUserInfo().success((function(t){e.result=JSON.stringify(t,null,"  ")})).error((function(){e.result="Failed to load user info"}))},loadProfile:function(){var e=this;this.$keycloak.loadUserProfile().success((function(t){e.result=JSON.stringify(t,null,"  ")})).error((function(){e.result="Failed to load user info"}))},showToken:function(){this.result=this.$keycloak.tokenParsed},showRefreshToken:function(){this.result=this.$keycloak.refreshTokenParsed},showIdToken:function(){this.result=this.$keycloak.idTokenParsed},showDetails:function(){this.result=this.$keycloak},showExpires:function(){if(this.$keycloak.tokenParsed){var e="Token Expires:\t\t"+new Date(1e3*(this.$keycloak.tokenParsed.exp+this.$keycloak.timeSkew)).toLocaleString()+"\n";e+="Token Expires in:\t"+Math.round(this.$keycloak.tokenParsed.exp+this.$keycloak.timeSkew-(new Date).getTime()/1e3)+" seconds\n",this.$keycloak.refreshTokenParsed&&(e+="Refresh Token Expires:\t"+new Date(1e3*(this.$keycloak.refreshTokenParsed.exp+this.$keycloak.timeSkew)).toLocaleString()+"\n",e+="Refresh Expires in:\t"+Math.round(this.$keycloak.refreshTokenParsed.exp+this.$keycloak.timeSkew-(new Date).getTime()/1e3)+" seconds"),this.result=e}else this.result="Not authenticated"},updateProfile:function(){var e=this.$keycloak.createAccountUrl().split("?")[0],t=new XMLHttpRequest;t.open("POST",e,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Authorization","bearer "+this.$keycloak.token);var s=this;t.onreadystatechange=function(){4===t.readyState&&(200===t.status?s.result="Success":s.result="Failed")},t.send('{"email":"myemail@foo.bar","firstName":"test","lastName":"bar"}')}}}),F=G,q=s("8336"),M=Object(u["a"])(F,P,L,!1,null,null,null),H=M.exports;w()(M,{VBtn:q["a"]});var K={name:"App",components:{Alert:j,TheHeader:h,TheNavBar:b,TheFooter:R,KeycloakDevTools:H},data:function(){return{vueCliMode:"production",showKeycloakTools:!1}},mounted:function(){var e=["view-events","manage-users","view-users","query-clients","query-groups","query-users"],t=[];this.$keycloak.tokenParsed.resource_access&&(t=this.$keycloak.tokenParsed.resource_access["realm-management"].roles);var s=B(e,t);s.length>0&&this.$store.commit("alert/setAlert",{message:"You are missing roles required to use this application.\n          Missing roles: ".concat(s.join(", "),"."),type:"error"})}};function B(e,t){var s=[];return e.forEach((function(e){t.includes(e)||s.push(e)})),s}var J=K,z=(s("d380"),s("1082"),s("128d"),s("7496")),Y=s("ac7c"),W=Object(u["a"])(J,a,n,!1,null,null,null),X=W.exports;w()(W,{VApp:z["a"],VCheckbox:Y["a"]});var Q=s("f309");r["a"].use(Q["a"]);var Z=new Q["a"]({theme:{themes:{light:{primary:"#003366",secondary:"#38598a",textLink:"#1A5A96"}}}}),ee=s("8c4f"),te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("router-view")],1)},se=[],re={},ae=Object(u["a"])(re,te,se,!1,null,null,null),ne=ae.exports,oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"col-6"},[s("label",{attrs:{for:"user-search"}},[e._v(" Search "),s("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[s("v-icon",e._g({attrs:{small:""}},r),[e._v("mdi-help-circle")])]}}])},[s("span",[e._v("Search by username, email, or name")])])],1),s("v-text-field",{attrs:{id:"user-search",outlined:"",dense:"",placeholder:"Username, email, name, or ID"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUser(t)}},model:{value:e.userSearchInput,callback:function(t){e.userSearchInput=t},expression:"userSearchInput"}})],1),s("v-col",{staticClass:"col-1"},[s("v-btn",{staticClass:"secondary",attrs:{id:"search-button",medium:""},nativeOn:{click:function(t){return e.searchUser(t)}}},[e._v("Search Users")])],1)],1),s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"col-12"},[s("v-data-table",{staticClass:"base-table select-table",attrs:{id:"users-table",headers:e.headers,items:e.searchResults,"footer-props":e.footerProps,loading:e.userSearchLoadingStatus,"loading-text":"Searching for users"},on:{"click:row":e.selectUser}})],1)],1),s("v-btn",{staticClass:"secondary",attrs:{id:"create-user-button",medium:""},nativeOn:{click:function(t){return e.goToCreateUser(t)}}},[e._v("Create New User")])],1)},ie=[],ce=(s("99af"),s("b85c")),le=(s("96cf"),s("1da1")),ue=s("bc3a"),de=s.n(ue),he=s("68ad"),fe=s.n(he),me=new fe.a,pe={responseMode:"fragment",flow:"standard",onLoad:"login-required",pkceMethod:"S256"},ve=me.login;me.login=function(e){return e.idpHint="idir",ve(e)},me.init(pe);var ge=me;function be(){function e(){var e=ge.authServerUrl+"admin/realms/"+ge.realm,t=de.a.create({baseURL:e,headers:{Authorization:"Bearer "+ge.token}});return t}return ge.updateToken(0).then(e)}var ke="/users",ye="role-mappings/clients",_e="groups",xe={get:function(e){return e?be().then((function(t){return t.get("".concat(ke).concat(e))})):be().then((function(e){return e.get("".concat(ke))}))},getUser:function(e){return be().then((function(t){return t.get("".concat(ke,"/").concat(e))}))},createUser:function(e){return be().then((function(t){return t.post("".concat(ke),e)}))},updateUser:function(e,t){return be().then((function(s){return s.put("".concat(ke,"/").concat(e),t)}))},getUserAvailableClientRoles:function(e,t){return be().then((function(s){return s.get("".concat(ke,"/").concat(e,"/").concat(ye,"/").concat(t,"/available"))}))},getUserActiveClientRoles:function(e,t){return be().then((function(s){return s.get("".concat(ke,"/").concat(e,"/").concat(ye,"/").concat(t))}))},getUserEffectiveClientRoles:function(e,t){return be().then((function(s){return s.get("".concat(ke,"/").concat(e,"/").concat(ye,"/").concat(t,"/composite"))}))},addUserClientRoles:function(e,t,s){return be().then((function(r){return r.post("".concat(ke,"/").concat(e,"/").concat(ye,"/").concat(t,"/"),s)}))},deleteUserClientRoles:function(e,t,s){var r={data:s};return be().then((function(s){return s.delete("".concat(ke,"/").concat(e,"/").concat(ye,"/").concat(t,"/"),r)}))},getUserGroups:function(e){return be().then((function(t){return t.get("".concat(ke,"/").concat(e,"/").concat(_e))}))},addGroupToUser:function(e,t){return be().then((function(s){return s.put("".concat(ke,"/").concat(e,"/").concat(_e,"/").concat(t))}))},removeGroupFromUser:function(e,t){return be().then((function(s){return s.delete("".concat(ke,"/").concat(e,"/").concat(_e,"/").concat(t))}))},addUsernamesToEvents:function(e){var t=this;return Object(le["a"])(regeneratorRuntime.mark((function s(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:r=Object(ce["a"])(e),s.prev=1,r.s();case 3:if((a=r.n()).done){s.next=21;break}if(n=a.value,o="username-"+n.userId,sessionStorage[o]){s.next=18;break}return s.prev=7,s.next=10,t.getUser(n.userId);case 10:i=s.sent,sessionStorage[o]=i.data.username,s.next=18;break;case 14:s.prev=14,s.t0=s["catch"](7),console.log(s.t0),sessionStorage[o]="no user found";case 18:n.username=sessionStorage[o];case 19:s.next=3;break;case 21:s.next=26;break;case 23:s.prev=23,s.t1=s["catch"](1),r.e(s.t1);case 26:return s.prev=26,r.f(),s.finish(26);case 29:case"end":return s.stop()}}),s,null,[[1,23,26,29],[7,14]])})))()},addAdminNamesToEvents:function(e){var t=this;return Object(le["a"])(regeneratorRuntime.mark((function s(){var r,a,n,o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:r=Object(ce["a"])(e),s.prev=1,r.s();case 3:if((a=r.n()).done){s.next=21;break}if(n=a.value,o="name-"+n.authDetails.userId,sessionStorage[o]){s.next=18;break}return s.prev=7,s.next=10,t.getUser(n.authDetails.userId);case 10:i=s.sent,sessionStorage[o]="".concat(i.data.firstName," ").concat(i.data.lastName),s.next=18;break;case 14:s.prev=14,s.t0=s["catch"](7),console.log(s.t0),sessionStorage[o]="no user found";case 18:n.authDetails.fullName=sessionStorage[o];case 19:s.next=3;break;case 21:s.next=26;break;case 23:s.prev=23,s.t1=s["catch"](1),r.e(s.t1);case 26:return s.prev=26,r.f(),s.finish(26);case 29:case"end":return s.stop()}}),s,null,[[1,23,26,29],[7,14]])})))()}},Ue={name:"UserSearch",data:function(){return{headers:[{text:"Username",value:"username",class:"table-header"},{text:"First name",value:"firstName",class:"table-header"},{text:"Last name",value:"lastName",class:"table-header"},{text:"Email",value:"email",class:"table-header"},{text:"Enabled",value:"enabled",class:"table-header"},{text:"Keycloak User ID",value:"id",class:"table-header"}],footerProps:{"items-per-page-options":[15]},userSearchInput:"",searchResults:[],userSearchLoadingStatus:!1}},methods:{selectUser:function(e){this.$store.commit("alert/dismissAlert"),this.$router.push({name:"UserUpdate",params:{userid:e.id}})},goToCreateUser:function(){this.$store.commit("alert/dismissAlert"),this.$router.push({name:"UserCreate"})},searchUser:function(){var e=this;this.userSearchLoadingStatus=!0,xe.get("?briefRepresentation=true&first=0&max=300&search="+this.userSearchInput).then((function(t){e.searchResults=t.data})).catch((function(t){e.$store.commit("alert/setAlert",{message:"User search failed: "+t,type:"error"}),window.scrollTo(0,0)})).finally((function(){return e.userSearchLoadingStatus=!1}))}}},we=Ue,Ee=(s("61c2"),s("8fea")),Ce=s("132d"),Ie=s("8654"),Re=s("3a2f"),Te=Object(u["a"])(we,oe,ie,!1,null,"b13953d2",null),Se=Te.exports;w()(Te,{VBtn:q["a"],VCol:E["a"],VDataTable:Ee["a"],VIcon:Ce["a"],VRow:C["a"],VTextField:Ie["a"],VTooltip:Re["a"]});var Ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.user.username,expression:"user.username"}],attrs:{id:"user-info"}},[s("h1",[e._v("Update - "+e._s(e.user.username))]),s("user-details",{ref:"userDetails",attrs:{userId:this.$route.params.userid}},[s("v-btn",{staticClass:"secondary",attrs:{id:"submit-button",medium:""},on:{click:function(t){return t.preventDefault(),e.updateUser(t)}}},[e._v("Update User")])],1),s("user-update-roles",{attrs:{userId:this.$route.params.userid}}),s("user-update-groups",{attrs:{userId:this.$route.params.userid}})],1)},$e=[],De=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"user"}},[s("v-card",{staticClass:"subgroup",attrs:{outlined:""}},[s("h2",[e._v("User Details")]),s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"col-7"},[s("v-form",{ref:"form"},[s("label",{staticClass:"required",attrs:{for:"user-name",disabled:!!e.userId}},[e._v("Username")]),e.userId?e._e():s("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[s("v-icon",e._g({attrs:{id:"user-name-tooltip-icon",small:""}},r),[e._v("mdi-help-circle")])]}}],null,!1,1753941226)},[s("span",[e._v("Username should be the exact user id followed directly by @idir, @bceid, or @phsa in alignment with the digital id type (e.g. userjane@idir)")])]),s("v-text-field",{attrs:{dense:"",disabled:!!e.userId,outlined:"",id:"user-name",required:"",rules:[function(e){return!!e||"Username is required"}]},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),s("label",{staticClass:"required",attrs:{for:"first-name"}},[e._v("First Name")]),s("v-text-field",{attrs:{dense:"",outlined:"",id:"first-name",required:"",rules:[function(e){return!!e||"First Name is required"}]},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),s("label",{staticClass:"required",attrs:{for:"last-name"}},[e._v("Last Name")]),s("v-text-field",{attrs:{dense:"",outlined:"",id:"last-name",required:"",rules:[function(e){return!!e||"Last Name is required"}]},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}}),s("label",{staticClass:"required",attrs:{for:"email"}},[e._v("Email Address")]),s("v-text-field",{attrs:{dense:"",outlined:"",id:"email",required:"",rules:e.emailRules,type:"email"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),s("label",{attrs:{for:"phone"}},[e._v("Telephone Number")]),s("v-text-field",{attrs:{dense:"",outlined:"",id:"phone"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),s("label",{attrs:{for:"org-details"}},[e._v("Organization")]),s("v-autocomplete",{attrs:{id:"org-details",items:e.$options.organizations,dense:"",outlined:""},model:{value:e.org_details,callback:function(t){e.org_details=t},expression:"org_details"}}),s("label",{attrs:{for:"notes"}},[e._v("Notes")]),s("v-textarea",{attrs:{outlined:"",dense:"",id:"notes",maxlength:"255"},model:{value:e.access_team_notes,callback:function(t){e.access_team_notes=t},expression:"access_team_notes"}}),s("label",{attrs:{for:"enabled-radio"}},[e._v("Lockout Status")]),s("v-radio-group",{attrs:{id:"enabled-radio",row:"",height:"1"},model:{value:e.computedLockout,callback:function(t){e.computedLockout=t},expression:"computedLockout"}},e._l(e.LOCK_STATES,(function(e){return s("v-radio",{key:e,attrs:{label:e,value:e}})})),1),s("label",{class:[e.enabled?"disabled":"required"],attrs:{for:"lockout-reason"}},[e._v("Lockout Reason")]),s("v-text-field",{attrs:{dense:"",outlined:"",id:"lockout-reason",disabled:e.enabled,required:!e.enabled,rules:[function(t){return!!e.enabled||(!!t&&"string"===typeof t||Array.isArray(t)&&!!t[0]||"Lockout Reason is required")}]},model:{value:e.lockout_reason,callback:function(t){e.lockout_reason=t},expression:"lockout_reason"}})],1)],1),s("v-col",{staticClass:"col-4",staticStyle:{"margin-left":"30px","padding-left":"20px","border-left":"1px solid #efefef"}},[s("label",{attrs:{for:"linked-idps"}},[e._v("Linked Identity Types")]),s("ul",{staticStyle:{"margin-top":"5px","list-style":"square"},attrs:{id:"linked-idps"}},e._l(e.federatedIdentities,(function(t){return s("li",{key:t.id},[e._v(" "+e._s(e._f("formatIdentityProvider")(t.identityProvider))+" ["+e._s(t.userName)+"] ")])})),0)])],1),e._t("default")],2)],1)},Oe=[],Ne=(s("d81d"),s("b0c0"),s("f29e")),Ve={name:"UserDetails",props:["userId"],organizations:Ne.map((function(e){return e.value=JSON.stringify(e),e.text="".concat(e.id," - ").concat(e.name),e})),data:function(){return{emailRules:[function(e){return!!e||"Email is required"},function(e){return/^\S+@\S+$/.test(e)||"Email is not valid"}],ENABLED:"Enabled",LOCKED:"Locked",REVOKED:"Revoked"}},created:function(){var e=this;return Object(le["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.commit("user/resetState"),!e.userId){t.next=4;break}return t.next=4,e.getUser();case 4:case"end":return t.stop()}}),t)})))()},methods:{getUser:function(){var e=this;return xe.getUser(this.userId).then((function(t){e.user=t.data})).catch((function(e){console.log(e)}))}},filters:{formatIdentityProvider:function(e){var t={phsa:"PHSA",moh_idp:"MoH LDAP",idir:"IDIR",bceid:"BCeID",bcsc:"BCSC"};return t[e]||e}},computed:{LOCK_STATES:function(){return[this.ENABLED,this.REVOKED,this.LOCKED]},computedLockout:{get:function(){return this.enabled?this.ENABLED:this.revoked?this.REVOKED:this.LOCKED},set:function(e){if(e===this.ENABLED)this.enabled=!0,this.revoked=!1,this.lockout_reason="";else if(e===this.REVOKED)this.enabled=!1,this.revoked=!0;else{if(e!==this.LOCKED)throw Error("Unrecognized lock state '".concat(e,"'"));this.enabled=!1,this.revoked=!1}}},user:{get:function(){return this.$store.state.user},set:function(e){this.$store.commit("user/setUser",e)}},username:{get:function(){return this.$store.state.user.username},set:function(e){this.$store.commit("user/setUsername",e)}},firstName:{get:function(){return this.$store.state.user.firstName},set:function(e){this.$store.commit("user/setFirstName",e)}},lastName:{get:function(){return this.$store.state.user.lastName},set:function(e){this.$store.commit("user/setLastName",e)}},email:{get:function(){return this.$store.state.user.email},set:function(e){this.$store.commit("user/setEmail",e)}},enabled:{get:function(){return this.$store.state.user.enabled},set:function(e){this.$store.commit("user/setEnabled",e)}},phone:{get:function(){return this.$store.state.user.attributes.phone},set:function(e){this.$store.commit("user/setPhone",e)}},org_details:{get:function(){var e=this.$store.state.user.attributes.org_details;return Array.isArray(e)?e[0]:e},set:function(e){this.$store.commit("user/setOrgDetails",e)}},lockout_reason:{get:function(){return this.$store.state.user.attributes.lockout_reason},set:function(e){this.$store.commit("user/setLockoutReason",e)}},revoked:{get:function(){return this.$store.state.user.attributes.revoked},set:function(e){this.$store.commit("user/setRevoked",e)}},access_team_notes:{get:function(){return this.$store.state.user.attributes.access_team_notes},set:function(e){this.$store.commit("user/setAccessTeamNotes",e)}},federatedIdentities:{get:function(){return this.$store.state.user.federatedIdentities}}}},je=Ve,Pe=(s("031e"),s("c6a6")),Le=s("b0af"),Ge=s("4bd4"),Fe=s("67b6"),qe=s("43a6"),Me=s("a844"),He=Object(u["a"])(je,De,Oe,!1,null,"9482b528",null),Ke=He.exports;w()(He,{VAutocomplete:Pe["a"],VCard:Le["a"],VCol:E["a"],VForm:Ge["a"],VIcon:Ce["a"],VRadio:Fe["a"],VRadioGroup:qe["a"],VRow:C["a"],VTextField:Ie["a"],VTextarea:Me["a"],VTooltip:Re["a"]});var Be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{staticClass:"subgroup",attrs:{outlined:""}},[s("h2",[e._v("User Roles")]),s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"col-7"},[s("label",{attrs:{for:"select-client"}},[e._v("Application")]),s("v-autocomplete",{attrs:{id:"select-client",outlined:"",dense:"",items:e.clients,"item-text":"clientId","item-value":"id",placeholder:"Select an Application"},on:{change:function(t){return e.getUserClientRoles()}},model:{value:e.selectedClientId,callback:function(t){e.selectedClientId=t},expression:"selectedClientId"}})],1)],1),e.selectedClientId?s("div",[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"col-4"},[s("label",[e._v("Roles")]),e._l(e.clientRoles,(function(t,r){return s("v-checkbox",{key:t.name,attrs:{"hide-details":"auto",id:"role-"+r,value:t,label:t.name},model:{value:e.selectedRoles,callback:function(t){e.selectedRoles=t},expression:"selectedRoles"}})}))],2),s("v-col",{staticClass:"col-4"},[s("label",[e._v(" Effective Roles "),s("v-tooltip",{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[s("v-icon",e._g({attrs:{small:""}},r),[e._v("mdi-help-circle")])]}}],null,!1,488255796)},[s("span",[e._v(" Effective roles represent all roles assigned to a user for this client. "),s("br"),e._v("This may include roles provided by group membership which cannot be directly removed. ")])])],1),e._l(e.effectiveClientRoles,(function(t){return s("v-checkbox",{key:t.name,attrs:{"hide-details":"auto",disabled:"disabled",value:t,label:t.name},model:{value:e.effectiveClientRoles,callback:function(t){e.effectiveClientRoles=t},expression:"effectiveClientRoles"}})}))],2)],1),e.selectedClientId?s("div",{staticClass:"my-6"},[s("v-btn",{staticClass:"secondary",attrs:{id:"save-user-roles",medium:""},on:{click:function(t){return e.updateUserClientRoles()}}},[e._v("Save User Roles")])],1):e._e()],1):e._e()],1)},Je=[],ze=(s("4de4"),s("3ca3"),s("ddb0"),s("2909")),Ye="/clients",We={get:function(){return be().then((function(e){return e.get("".concat(Ye))}))},getRoles:function(e){return be().then((function(t){return t.get("".concat(Ye,"/").concat(e,"/roles"))}))},addClientNamesToEvents:function(e){var t=this;return Object(le["a"])(regeneratorRuntime.mark((function s(){var r,a,n,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.get();case 2:r=s.sent,r.data.map((function(e){return sessionStorage[e.id]=e.clientId})),a=Object(ce["a"])(e);try{for(a.s();!(n=a.n()).done;)o=n.value,o.clientId&&sessionStorage[o.clientId]?o.clientName=sessionStorage[o.clientId]:o.clientName="no client found"}catch(i){a.e(i)}finally{a.f()}case 6:case"end":return s.stop()}}),s)})))()}},Xe={name:"UserUpdateRoles",props:["userId"],data:function(){return{clients:[],selectedClientId:null,clientRoles:[],effectiveClientRoles:[],selectedRoles:[]}},created:function(){var e=this;return Object(le["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getClients();case 2:case"end":return t.stop()}}),t)})))()},methods:{getClients:function(){var e=this;return We.get().then((function(t){e.clients=t.data})).catch((function(e){console.log(e)}))},getUserClientRoles:function(){var e=Object(le["a"])(regeneratorRuntime.mark((function e(){var t,s,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.effectiveClientRoles=[],this.clientRoles=[],this.selectedRoles=[],e.next=5,Promise.all([this.getUserEffectiveClientRoles(),this.getUserAvailableClientRoles(),this.getUserActiveClientRoles()]);case 5:n=e.sent,(t=this.clientRoles).push.apply(t,Object(ze["a"])(n[1].data)),(s=this.clientRoles).push.apply(s,Object(ze["a"])(n[2].data)),(r=this.selectedRoles).push.apply(r,Object(ze["a"])(n[2].data)),(a=this.effectiveClientRoles).push.apply(a,Object(ze["a"])(n[0].data)),this.clientRoles.sort((function(e,t){return e.name.localeCompare(t.name)}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getUserActiveClientRoles:function(){return xe.getUserActiveClientRoles(this.userId,this.selectedClientId).catch((function(e){console.log(e)}))},getUserAvailableClientRoles:function(){return xe.getUserAvailableClientRoles(this.userId,this.selectedClientId).catch((function(e){console.log(e)}))},getUserEffectiveClientRoles:function(){return xe.getUserEffectiveClientRoles(this.userId,this.selectedClientId).catch((function(e){console.log(e)}))},updateUserClientRoles:function(){var e=this,t=this.clientRoles.filter((function(t){return!e.selectedRoles.includes(t)})),s=this.clientRoles.filter((function(t){return e.selectedRoles.includes(t)}));Promise.all([xe.deleteUserClientRoles(this.userId,this.selectedClientId,t),xe.addUserClientRoles(this.userId,this.selectedClientId,s)]).then((function(){e.getUserClientRoles(),e.$store.commit("alert/setAlert",{message:"Roles updated successfully",type:"success"}),window.scrollTo(0,0)})).catch((function(t){e.$store.commit("alert/setAlert",{message:"Error updating roles: "+t,type:"error"}),window.scrollTo(0,0)}))}}},Qe=Xe,Ze=Object(u["a"])(Qe,Be,Je,!1,null,null,null),et=Ze.exports;w()(Ze,{VAutocomplete:Pe["a"],VBtn:q["a"],VCard:Le["a"],VCheckbox:Y["a"],VCol:E["a"],VIcon:Ce["a"],VRow:C["a"],VTooltip:Re["a"]});var tt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{staticClass:"subgroup",attrs:{outlined:"",disabled:!e.adminUser}},[s("h2",[e._v("User Groups")]),s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"col-4"},e._l(e.allGroups,(function(t,r){return s("v-checkbox",{key:t.id,attrs:{"hide-details":"auto",id:"group-"+r,value:t,label:t.name},model:{value:e.selectedGroups,callback:function(t){e.selectedGroups=t},expression:"selectedGroups"}})})),1)],1),s("div",{staticClass:"my-6"},[e.adminUser?s("v-btn",{staticClass:"secondary",attrs:{id:"save-user-groups",medium:""},on:{click:function(t){return e.updateUserGroups()}}},[e._v(" Save User Groups ")]):e._e()],1)],1)},st=[],rt=(s("45fc"),"/groups"),at={get:function(e){return e?be().then((function(t){return t.get("".concat(rt).concat(e))})):be().then((function(e){return e.get("".concat(rt))}))}},nt={name:"UserUpdateGroups",props:["userId"],data:function(){return{adminUser:!1,currentGroups:[],allGroups:[],selectedGroups:[]}},created:function(){var e=this;return Object(le["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.checkIfAdmin(),t.next=3,e.getUserGroupsData();case 3:case"end":return t.stop()}}),t)})))()},methods:{checkIfAdmin:function(){this.$keycloak.tokenParsed.resource_access["user-management"]&&this.$keycloak.tokenParsed.resource_access["user-management"].roles.includes("user-management-admin")&&(this.adminUser=!0)},getUserGroupsData:function(){var e=Object(le["a"])(regeneratorRuntime.mark((function e(){var t,s,r,a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.currentGroups=[],this.allGroups=[],this.selectedGroups=[],e.next=5,Promise.all([xe.getUserGroups(this.userId),at.get()]).catch((function(e){n.$store.commit("alert/setAlert",{message:"Error updating loading user groups: "+e,type:"error"})}));case 5:a=e.sent,(t=this.currentGroups).push.apply(t,Object(ze["a"])(a[0].data)),(s=this.selectedGroups).push.apply(s,Object(ze["a"])(a[0].data)),(r=this.allGroups).push.apply(r,Object(ze["a"])(a[1].data)),this.allGroups=this.allGroups.map((function(e){var t=e.id,s=e.name,r=e.path;return{id:t,name:s,path:r}}));case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),updateUserGroups:function(){var e,t=this,s=[],r=Object(ce["a"])(this.allGroups);try{var a=function(){var r=e.value;t.currentGroups.some((function(e){return e.id===r.id}))&&!t.selectedGroups.some((function(e){return e.id===r.id}))&&s.push(xe.removeGroupFromUser(t.userId,r.id)),!t.currentGroups.some((function(e){return e.id===r.id}))&&t.selectedGroups.some((function(e){return e.id===r.id}))&&s.push(xe.addGroupToUser(t.userId,r.id))};for(r.s();!(e=r.n()).done;)a()}catch(n){r.e(n)}finally{r.f()}Promise.all(s).then((function(){t.checkIfAdmin(),t.getUserGroupsData(),t.$store.commit("alert/setAlert",{message:"User Groups updated successfully",type:"success"})})).catch((function(e){t.$store.commit("alert/setAlert",{message:"Error updating user groups: "+e,type:"error"})})).finally((function(){window.scrollTo(0,0)}))}}},ot=nt,it=Object(u["a"])(ot,tt,st,!1,null,null,null),ct=it.exports;w()(it,{VBtn:q["a"],VCard:Le["a"],VCheckbox:Y["a"],VCol:E["a"],VRow:C["a"]});var lt={name:"UserInfo",components:{UserUpdateGroups:ct,UserDetails:Ke,UserUpdateRoles:et},methods:{updateUser:function(){var e=this;if(!this.$refs.userDetails.$refs.form.validate())return this.$store.commit("alert/setAlert",{message:"Please correct errors before submitting",type:"error"}),void window.scrollTo(0,0);xe.updateUser(this.$route.params.userid,this.user).then((function(){e.$store.commit("alert/setAlert",{message:"User updated successfully",type:"success"})})).catch((function(t){e.$store.commit("alert/setAlert",{message:"Error updating user: "+t,type:"error"})})).finally((function(){window.scrollTo(0,0)}))}},computed:{user:function(){return this.$store.state.user}}},ut=lt,dt=Object(u["a"])(ut,Ae,$e,!1,null,null,null),ht=dt.exports;w()(dt,{VBtn:q["a"]});var ft=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"user"}},[s("h1",[e._v("Create New User")]),s("user-details",{ref:"userDetails"},[s("v-btn",{staticClass:"secondary",attrs:{id:"submit-button",medium:""},on:{click:function(t){return e.createUser()}}},[e._v("Create User")])],1)],1)},mt=[],pt=(s("baa5"),{name:"UserCreate",components:{UserDetails:Ke},methods:{createUser:function(){var e=this;if(!this.$refs.userDetails.$refs.form.validate())return this.$store.commit("alert/setAlert",{message:"Please correct errors before submitting",type:"error"}),void window.scrollTo(0,0);xe.createUser(this.user).then((function(t){var s=t.headers.location,r=s.substring(s.lastIndexOf("/")+1);e.$store.commit("alert/setAlert",{message:"User created successfully",type:"success"}),e.$router.push({name:"UserUpdate",params:{userid:r}})})).catch((function(t){e.$store.commit("alert/setAlert",{message:"Error creating new user: "+t,type:"error"})})).finally((function(){window.scrollTo(0,0)}))}},computed:{user:function(){return this.$store.state.user}}}),vt=pt,gt=Object(u["a"])(vt,ft,mt,!1,null,null,null),bt=gt.exports;w()(gt,{VBtn:q["a"]});var kt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{attrs:{id:"search-inputs"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEvents(t)}}},[s("label",{attrs:{for:"user-id"}},[e._v("Keycloak User ID")]),s("v-text-field",{attrs:{id:"user-id",dense:"",outlined:""},model:{value:e.searchUserId,callback:function(t){e.searchUserId=t},expression:"searchUserId"}}),s("label",{attrs:{for:"app-id"}},[e._v("Application name")]),s("v-text-field",{attrs:{id:"app-id",dense:"",outlined:""},model:{value:e.searchApplicationName,callback:function(t){e.searchApplicationName=t},expression:"searchApplicationName"}}),s("label",{attrs:{for:"from-date"}},[e._v("Date (from)")]),s("v-text-field",{attrs:{id:"from-date",dense:"",outlined:"",hint:"yyyy-MM-dd"},model:{value:e.searchDateFrom,callback:function(t){e.searchDateFrom=t},expression:"searchDateFrom"}}),s("label",{attrs:{for:"to-date"}},[e._v("Date (to)")]),s("v-text-field",{attrs:{id:"to-date",dense:"",outlined:"",hint:"yyyy-MM-dd"},model:{value:e.searchDateTo,callback:function(t){e.searchDateTo=t},expression:"searchDateTo"}})],1),s("v-btn",{staticClass:"secondary",attrs:{id:"search-button",medium:""},nativeOn:{click:function(t){return e.searchEvents(t)}}},[e._v("Search")]),s("h1",{staticStyle:{"margin-bottom":"10px"}},[e._v("Search Results")]),s("v-text-field",{attrs:{"append-icon":"mdi-magnify",placeholder:"Filter Results"},model:{value:e.filterEvents,callback:function(t){e.filterEvents=t},expression:"filterEvents"}}),s("v-data-table",{staticClass:"base-table",attrs:{headers:e.headers,items:e.events,"items-per-page":15,"show-expand":"","single-expand":e.singleExpand,"item-key":"key","loading-text":"Loading events",loading:e.loadingStatus,search:e.filterEvents,page:e.pageValue,expanded:e.expandedValues},on:{"update:page":function(t){e.pageValue=t},"update:expanded":function(t){e.expandedValues=t}},scopedSlots:e._u([{key:"expanded-item",fn:function(t){var r=t.headers,a=t.item;return[s("td",{attrs:{colspan:r.length}},[s("pre",[e._v("User ID: "+e._s(a.userId))])])]}}])}),s("button",{on:{click:e.getAllEvents}},[e._v("Refresh")])],1)},yt=[],_t=(s("25f0"),s("2b3d"),s("3835")),xt="/events?type=LOGIN&type=LOGOUT&max=100",Ut={getEvents:function(e){var t=e?"".concat(xt,"&").concat(e):xt;return be().then((function(e){return e.get(t)}))}},wt={dateStyle:"short",timeStyle:"short"},Et=new Intl.DateTimeFormat(void 0,wt).format,Ct={name:"EventLog",data:function(){return{searchUserId:"",searchApplicationName:"",searchDateFrom:"",searchDateTo:"",filterEvents:"",loadingStatus:!1,singleExpand:!0,events:[],headers:[{text:"Time",value:"readableDate"},{text:"Username",value:"username"},{text:"Event type",value:"type"},{text:"Application",value:"clientId"},{text:"Details",value:"data-table-expand"}],pageValue:1,expandedValues:[]}},created:function(){this.getAllEvents()},methods:{searchEvents:function(){var e=new URLSearchParams;[{name:"user",value:this.searchUserId},{name:"client",value:this.searchApplicationName},{name:"dateFrom",value:this.searchDateFrom},{name:"dateTo",value:this.searchDateTo}].map((function(t){t.value&&e.append(t.name,t.value)})),this.getEvents((function(){return Ut.getEvents(e.toString())}))},getAllEvents:function(){this.getEvents(Ut.getEvents)},getEvents:function(){var e=Object(le["a"])(regeneratorRuntime.mark((function e(t){var s,r,a,n,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStatus=!0,e.prev=1,e.next=4,t();case 4:s=e.sent,this.events=s.data,r=Object(ce["a"])(this.events.entries());try{for(r.s();!(a=r.n()).done;)n=Object(_t["a"])(a.value,2),o=n[0],i=n[1],i.key=o,i.readableDate=Et(i.time),i.details||(i.details="no details")}catch(c){r.e(c)}finally{r.f()}return e.next=10,xe.addUsernamesToEvents(this.events);case 10:return e.prev=10,this.loadingStatus=!1,this.pageValue=1,this.expandedValues=[],e.finish(10);case 15:case"end":return e.stop()}}),e,this,[[1,,10,15]])})));function t(t){return e.apply(this,arguments)}return t}()}},It=Ct,Rt=(s("8905"),Object(u["a"])(It,kt,yt,!1,null,"7da842a1",null)),Tt=Rt.exports;w()(Rt,{VBtn:q["a"],VDataTable:Ee["a"],VTextField:Ie["a"]});var St=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{attrs:{id:"search-inputs"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEvents(t)}}},[s("label",{attrs:{for:"user-id"}},[e._v("Keycloak User ID")]),s("v-text-field",{attrs:{id:"user-id",dense:"",outlined:""},model:{value:e.searchUserId,callback:function(t){e.searchUserId=t},expression:"searchUserId"}}),s("label",{attrs:{for:"app-id"}},[e._v("Application ID")]),s("v-text-field",{attrs:{id:"app-id",dense:"",outlined:""},model:{value:e.searchClientId,callback:function(t){e.searchClientId=t},expression:"searchClientId"}}),s("label",{attrs:{for:"admin-id"}},[e._v("Administrator ID")]),s("v-text-field",{attrs:{id:"admin-id",dense:"",outlined:""},model:{value:e.searchAdministratorId,callback:function(t){e.searchAdministratorId=t},expression:"searchAdministratorId"}}),s("label",{attrs:{for:"from-date"}},[e._v("Date (from)")]),s("v-text-field",{attrs:{id:"from-date",dense:"",outlined:"",hint:"yyyy-MM-dd"},model:{value:e.searchDateFrom,callback:function(t){e.searchDateFrom=t},expression:"searchDateFrom"}}),s("label",{attrs:{for:"to-date"}},[e._v("Date (to)")]),s("v-text-field",{attrs:{id:"to-date",dense:"",outlined:"",hint:"yyyy-MM-dd"},model:{value:e.searchDateTo,callback:function(t){e.searchDateTo=t},expression:"searchDateTo"}})],1),s("v-btn",{staticClass:"secondary",attrs:{id:"search-button",medium:""},nativeOn:{click:function(t){return e.searchEvents(t)}}},[e._v("Search")]),s("h1",{staticStyle:{"margin-bottom":"10px"}},[e._v("Search Results")]),s("v-text-field",{attrs:{"append-icon":"mdi-magnify",placeholder:"Filter Results"},model:{value:e.filterEvents,callback:function(t){e.filterEvents=t},expression:"filterEvents"}}),s("v-data-table",{staticClass:"base-table",attrs:{headers:e.headers,items:e.adminEvents,"items-per-page":15,"show-expand":"","single-expand":e.singleExpand,"item-key":"key","loading-text":"Loading events",loading:e.loadingStatus,search:e.filterEvents,page:e.pageValue,expanded:e.expandedValues},on:{"update:page":function(t){e.pageValue=t},"update:expanded":function(t){e.expandedValues=t}},scopedSlots:e._u([{key:"expanded-item",fn:function(t){var r=t.headers,a=t.item;return[s("td",{attrs:{colspan:r.length}},[s("pre",[e._v("User ID: "+e._s(a.userId))]),s("pre",[e._v("Application ID: "+e._s(a.clientId))]),s("pre",[e._v("Data: "+e._s(e._f("pretty")(a.representation)))]),s("pre",[e._v("Administrator: "+e._s(a.authDetails))])])]}}])}),s("button",{on:{click:e.getAllEvents}},[e._v("Refresh")])],1)},At=[],$t="/admin-events?operationTypes=UPDATE&operationTypes=CREATE&operationTypes=DELETE&resourceTypes=USER&resourceTypes=CLIENT_ROLE_MAPPING&max=100",Dt={getEvents:function(e){var t=e?"".concat($t,"&").concat(e):$t;return be().then((function(e){return e.get(t)}))}},Ot={dateStyle:"short",timeStyle:"short"},Nt=new Intl.DateTimeFormat(void 0,Ot).format,Vt={name:"AdminEventLog",data:function(){return{searchUserId:"",searchClientId:"",searchAdministratorId:"",searchDateFrom:"",searchDateTo:"",filterEvents:"",loadingStatus:!1,singleExpand:!0,adminEvents:[],headers:[{text:"Time",value:"readableDate"},{text:"Administrator",value:"authDetails.fullName"},{text:"Event type",value:"operationType"},{text:"Resource type",value:"resourceType"},{text:"Username",value:"username"},{text:"Application",value:"clientName"},{text:"Details",value:"data-table-expand"}],pageValue:1,expandedValues:[]}},created:function(){this.getAllEvents()},methods:{searchEvents:function(){var e=jt.call(this);this.getEvents((function(){return Dt.getEvents(e)}))},getAllEvents:function(){this.getEvents(Dt.getEvents)},getEvents:function(){var e=Object(le["a"])(regeneratorRuntime.mark((function e(t){var s,r,a,n,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStatus=!0,e.prev=1,e.next=4,t();case 4:s=e.sent,this.adminEvents=s.data,r=Object(ce["a"])(this.adminEvents.entries());try{for(r.s();!(a=r.n()).done;)n=Object(_t["a"])(a.value,2),o=n[0],i=n[1],i.key=o,i.readableDate=Nt(i.time),i.userId=i.resourcePath.substring(6,42),i.resourcePath.includes("role-mappings/clients")&&(i.clientId=i.resourcePath.substring(65,101))}catch(c){r.e(c)}finally{r.f()}return e.next=10,We.addClientNamesToEvents(this.adminEvents);case 10:return e.next=12,xe.addUsernamesToEvents(this.adminEvents);case 12:return e.next=14,xe.addAdminNamesToEvents(this.adminEvents);case 14:return e.prev=14,this.loadingStatus=!1,this.pageValue=1,this.expandedValues=[],e.finish(14);case 19:case"end":return e.stop()}}),e,this,[[1,,14,19]])})));function t(t){return e.apply(this,arguments)}return t}()},filters:{pretty:function(e){return e?JSON.stringify(JSON.parse(e),null,2):"No further details available"}}};function jt(){var e=new URLSearchParams;return this.searchUserId&&this.searchClientId?e.append("resourcePath","users/".concat(this.searchUserId,"/role-mappings/clients/").concat(this.searchClientId,"/")):this.searchUserId?e.append("resourcePath","users/".concat(this.searchUserId,"*")):this.searchClientId&&e.append("resourcePath","*role-mappings/clients/".concat(this.searchClientId,"*")),this.searchAdministratorId&&e.append("authUser",this.searchAdministratorId),[{name:"dateFrom",value:this.searchDateFrom},{name:"dateTo",value:this.searchDateTo}].map((function(t){t.value&&e.append(t.name,t.value)})),e}var Pt=Vt,Lt=(s("9d3a"),Object(u["a"])(Pt,St,At,!1,null,"4c3c8201",null)),Gt=Lt.exports;w()(Lt,{VBtn:q["a"],VDataTable:Ee["a"],VTextField:Ie["a"]}),r["a"].use(ee["a"]);var Ft=[{path:"/",redirect:"/users"},{path:"/users",component:ne,children:[{path:"",component:Se,name:"UserSearch"},{path:"create",component:bt,name:"UserCreate"},{path:":userid",component:ht,name:"UserUpdate"}]},{path:"/event-log",name:"EventLog",component:Tt},{path:"/admin-event-log",name:"AdminEventLog",component:Gt}],qt=new ee["a"]({routes:Ft}),Mt=qt,Ht=function(){return{username:"",firstName:"",lastName:"",email:"",enabled:!0,attributes:{phone:"",org_details:"",lockout_reason:"",revoked:"",access_team_notes:""},federatedIdentities:[]}},Kt=Ht(),Bt={resetState:function(e){Object.assign(e,Ht())},setUser:function(e,t){e.username=t.username,e.firstName=t.firstName,e.lastName=t.lastName,e.email=t.email,e.enabled=t.enabled,t.attributes&&(e.attributes.phone=t.attributes.phone,e.attributes.org_details=t.attributes.org_details,e.attributes.lockout_reason=t.attributes.lockout_reason,e.attributes.revoked=t.attributes.revoked,e.attributes.access_team_notes=t.attributes.access_team_notes),e.federatedIdentities=t.federatedIdentities},setUsername:function(e,t){e.username=t},setFirstName:function(e,t){e.firstName=t},setLastName:function(e,t){e.lastName=t},setEmail:function(e,t){e.email=t},setEnabled:function(e,t){e.enabled=t},setPhone:function(e,t){e.attributes.phone=t},setOrgDetails:function(e,t){e.attributes.org_details=t},setLockoutReason:function(e,t){e.attributes.lockout_reason=t},setRevoked:function(e,t){e.attributes.revoked=t},setAccessTeamNotes:function(e,t){e.attributes.access_team_notes=t}},Jt={namespaced:!0,state:Kt,mutations:Bt},zt=function(){return{message:"",type:"success",active:!1}},Yt=zt(),Wt={setAlert:function(e,t){e.message=t.message,e.type=t.type,e.active=!0},dismissAlert:function(e){e.active=!1}},Xt={namespaced:!0,state:Yt,mutations:Wt};r["a"].use($["a"]);var Qt=new $["a"].Store({modules:{user:Jt,alert:Xt}});r["a"].config.productionTip=!1,r["a"].prototype.$keycloak=ge,ge.onAuthSuccess=function(){fetch("/webapp/config.json").then((function(e){return e.json()})).then((function(e){r["a"].prototype.$config=e,new r["a"]({vuetify:Z,router:Mt,store:Qt,render:function(e){return e(X)}}).$mount("#app")}))}},"61c2":function(e,t,s){"use strict";var r=s("08d0"),a=s.n(r);a.a},"731d":function(e,t,s){},"7c4b":function(e,t,s){},8905:function(e,t,s){"use strict";var r=s("731d"),a=s.n(r);a.a},8947:function(e,t,s){},"9d3a":function(e,t,s){"use strict";var r=s("4a77"),a=s.n(r);a.a},"9d64":function(e,t,s){e.exports=s.p+"img/logo.b9f0e48f.png"},bee3:function(e,t,s){"use strict";var r=s("7c4b"),a=s.n(r);a.a},d380:function(e,t,s){"use strict";var r=s("4b5a"),a=s.n(r);a.a},f29e:function(e){e.exports=JSON.parse('[{"id":"00000010","name":"Ministry of Health"},{"id":"00000025","name":"Government of Yukon - Dept of Health"},{"id":"00000032","name":"Providence Health Care"},{"id":"00001480","name":"TimberWest Forest Company"},{"id":"00001762","name":"Northern Health Authority"},{"id":"00001763","name":"Interior Health Authority"},{"id":"00001764","name":"Vancouver Island Health Authority"},{"id":"00001765","name":"Vancouver Coastal Health Authority"},{"id":"00001766","name":"Fraser Health Authority"},{"id":"00001767","name":"Provincial Health Services Authority"},{"id":"00002158","name":"Provider Registry Project"},{"id":"00005502","name":"ICBC - Head Office"},{"id":"00006501","name":"Belkorp Industries Inc - Parent"},{"id":"00015824","name":"First Nations Health Authority - Employees"}]')}});
//# sourceMappingURL=app.20bf01cd.js.map